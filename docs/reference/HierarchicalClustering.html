<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Automated hierarchical clustering with labeling of observations and groups — HierarchicalClustering • machinelearnr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Automated hierarchical clustering with labeling of observations and groups — HierarchicalClustering" />
<meta property="og:description" content="Versatile hierarchical clustering function that can use correlation or distance
clustering. The linkage can also be specified." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">machinelearnr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Examples.html">Examples</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Automated hierarchical clustering with labeling of observations and groups</h1>
    
    <div class="hidden name"><code>HierarchicalClustering.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Versatile hierarchical clustering function that can use correlation or distance
clustering. The linkage can also be specified.</p>
    </div>

    <pre class="usage"><span class='fu'>HierarchicalClustering</span><span class='op'>(</span>
  <span class='va'>working.data</span>,
  <span class='va'>clustering.columns</span>,
  <span class='va'>label.column.name</span>,
  <span class='va'>grouping.column.name</span>,
  <span class='va'>number.of.clusters.to.use</span>,
  distance_method <span class='op'>=</span> <span class='st'>"euclidean"</span>,
  <span class='va'>correlation_method</span>,
  <span class='va'>linkage_method_type</span>,
  <span class='va'>Use.correlation.for.hclust</span>,
  <span class='va'>terminal.branch.font.size</span>,
  <span class='va'>title.to.use</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>working.data</th>
      <td><p>A dataframe of data</p></td>
    </tr>
    <tr>
      <th>clustering.columns</th>
      <td><p>A vector of strings that indicate the names of columns to be used for clustering. The columns should be numerical.</p></td>
    </tr>
    <tr>
      <th>label.column.name</th>
      <td><p>A string that indicates the name of column to be used for labeling the terminal branches of the dendrogram.</p></td>
    </tr>
    <tr>
      <th>grouping.column.name</th>
      <td><p>A string that indicates the name of column to be used for coloring terminal branches. The column should contain numerical values and should be a factor. A value of 0 will result in a black terminal branch. A value of 1 will result in a red terminal branch.</p></td>
    </tr>
    <tr>
      <th>number.of.clusters.to.use</th>
      <td><p>A numerical value indicating how many clusters (main branches) to be colored.</p></td>
    </tr>
    <tr>
      <th>distance_method</th>
      <td><p>A string that specifies the distance method for clustering. Default option is "euclidean". See documentation for stats::dist() for all available options. This is only used if Use.correlation.for.hclust is FALSE.</p></td>
    </tr>
    <tr>
      <th>correlation_method</th>
      <td><p>A string that specifies the correlation method to be used for clustering. Default option is "spearman". See documentation for stats::cor() for all available options. This is only used if Use.correlation.for.hclust is TRUE.</p></td>
    </tr>
    <tr>
      <th>linkage_method_type</th>
      <td><p>A string that specifies the linkage method to be used for clustering. See documentation for stats::hclust() for all available options. Examples are "ward.D", "complete".</p></td>
    </tr>
    <tr>
      <th>Use.correlation.for.hclust</th>
      <td><p>A boolean specifying if correlation between observations should be used to cluster. If correlation is not used, then distance between observations is used instead.</p></td>
    </tr>
    <tr>
      <th>terminal.branch.font.size</th>
      <td><p>A numeric value specifying font size of the labels for the terminal branches as specified by label.column.name. Default value is 1.</p></td>
    </tr>
    <tr>
      <th>title.to.use</th>
      <td><p>A string that indicates the title of the plot.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with three objects:
1.hclust.res: The object outputted from stats::hclust().
2.dend1: The object outtputed from converting hclust.res into a dendrogram.
3.kcboot: The results from fpc::clusterboot() which evaluates the stability of the clusters.
4.title: Title to use for dendrogram
5.cluster.labels.renamed.reordered: Cluster group matched with labels of samples.
6.d: Table generated with kcboot to assess stability of clusters</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Correlation type, distance type, linkage type, and coloring of groups can
all be specified. The result is a dendrogram of the hierarchical clustering with
coloring scheme that shows which observations belong to which cluster. Additionally,
coloring of the terminal branches can be done with meta data so that the
meta data can be compared to the cluster assignment. Links to resources
used to make this function are provided in the code.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other Clustering functions: 
<code><a href='CalcOptimalNumClustersForKMeans.html'>CalcOptimalNumClustersForKMeans</a>()</code>,
<code><a href='GenerateParcoordForClusters.html'>GenerateParcoordForClusters</a>()</code>,
<code><a href='generate.2D.clustering.with.labeled.subgroup.html'>generate.2D.clustering.with.labeled.subgroup</a>()</code>,
<code><a href='generate.3D.clustering.with.labeled.subgroup.html'>generate.3D.clustering.with.labeled.subgroup</a>()</code>,
<code><a href='generate.plots.comparing.clusters.html'>generate.plots.comparing.clusters</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>id</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1a"</span>, <span class='st'>"1b"</span>, <span class='st'>"1c"</span>, <span class='st'>"1d"</span>, <span class='st'>"1e"</span>, <span class='st'>"1f"</span>, <span class='st'>"1g"</span>, <span class='st'>"2a"</span>, <span class='st'>"2b"</span>, <span class='st'>"2c"</span>, <span class='st'>"2d"</span>, <span class='st'>"3h"</span>, <span class='st'>"3i"</span>, <span class='st'>"3a"</span>,
       <span class='st'>"3b"</span>, <span class='st'>"3c"</span>, <span class='st'>"3d"</span>, <span class='st'>"3e"</span>, <span class='st'>"3f"</span>, <span class='st'>"3g"</span>, <span class='st'>"2g"</span>, <span class='st'>"2h"</span><span class='op'>)</span>

<span class='va'>x</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>18</span>, <span class='fl'>21</span>, <span class='fl'>22</span>, <span class='fl'>24</span>, <span class='fl'>26</span>, <span class='fl'>26</span>, <span class='fl'>27</span>, <span class='fl'>30</span>, <span class='fl'>31</span>, <span class='fl'>35</span>, <span class='fl'>39</span>, <span class='fl'>40</span>, <span class='fl'>41</span>, <span class='fl'>42</span>, <span class='fl'>44</span>, <span class='fl'>46</span>, <span class='fl'>47</span>, <span class='fl'>48</span>, <span class='fl'>49</span>, <span class='fl'>54</span>, <span class='fl'>35</span>, <span class='fl'>30</span><span class='op'>)</span>

<span class='va'>y</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>11</span>, <span class='fl'>22</span>, <span class='fl'>15</span>, <span class='fl'>12</span>, <span class='fl'>13</span>, <span class='fl'>14</span>, <span class='fl'>33</span>, <span class='fl'>39</span>, <span class='fl'>37</span>, <span class='fl'>44</span>, <span class='fl'>27</span>, <span class='fl'>29</span>, <span class='fl'>20</span>, <span class='fl'>28</span>, <span class='fl'>21</span>, <span class='fl'>30</span>, <span class='fl'>31</span>, <span class='fl'>23</span>, <span class='fl'>24</span>, <span class='fl'>40</span>, <span class='fl'>45</span><span class='op'>)</span>

<span class='va'>color</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>example.data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>id</span>, <span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>color</span><span class='op'>)</span>

<span class='co'>#dev.new()</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>example.data</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>example.data</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='va'>example.data</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>example.data</span><span class='op'>$</span><span class='va'>y</span>, labels <span class='op'>=</span> <span class='va'>id</span>, cex<span class='op'>=</span><span class='fl'>0.9</span>, font<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='img'><img src='HierarchicalClustering-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>results</span> <span class='op'>&lt;-</span> <span class='fu'>HierarchicalClustering</span><span class='op'>(</span>working.data <span class='op'>=</span> <span class='va'>example.data</span>,
                       clustering.columns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span><span class='op'>)</span>,
                       label.column.name <span class='op'>=</span> <span class='st'>"id"</span>,
                       grouping.column.name <span class='op'>=</span> <span class='st'>"color"</span>,
                       number.of.clusters.to.use <span class='op'>=</span> <span class='fl'>3</span>,
                       distance_method <span class='op'>=</span> <span class='st'>"euclidean"</span>,
                       correlation_method <span class='op'>=</span> <span class='cn'>NULL</span>,
                       linkage_method_type <span class='op'>=</span> <span class='st'>"ward.D"</span>,
                       Use.correlation.for.hclust <span class='op'>=</span> <span class='cn'>FALSE</span>,
                       terminal.branch.font.size <span class='op'>=</span> <span class='fl'>1</span>,
                       title.to.use <span class='op'>=</span> <span class='st'>"Clustering based on x and y data"</span><span class='op'>)</span>
                       
<span class='va'>hclust.res</span> <span class='op'>&lt;-</span> <span class='va'>results</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
<span class='va'>dend</span> <span class='op'>&lt;-</span> <span class='va'>results</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>
<span class='va'>kcboot.res</span> <span class='op'>&lt;-</span> <span class='va'>results</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span>
<span class='va'>title.to.use</span> <span class='op'>&lt;-</span> <span class='va'>results</span><span class='op'>[[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>]</span>
<span class='va'>labeled.samples</span> <span class='op'>&lt;-</span> <span class='va'>results</span><span class='op'>[[</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>]</span>
<span class='va'>stability.table</span> <span class='op'>&lt;-</span> <span class='va'>results</span><span class='op'>[[</span><span class='fl'>6</span><span class='op'>]</span><span class='op'>]</span>
                     
<span class='co'>#Plot dendrogram                         </span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>dend</span>, main <span class='op'>=</span> <span class='va'>title.to.use</span><span class='op'>)</span>
</div><div class='input'>
<span class='co'>#Add legend to dendrogram</span>
<span class='va'>legend.labels.to.use</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>example.data</span><span class='op'>[</span>,<span class='st'>"color"</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>col.to.use</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>example.data</span><span class='op'>[</span>,<span class='st'>"color"</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span>
<span class='va'>pch.to.use</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>20</span>, times <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>legend.labels.to.use</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"topright"</span>,
      legend <span class='op'>=</span> <span class='va'>legend.labels.to.use</span>,
      col <span class='op'>=</span> <span class='va'>col.to.use</span>,
      pch <span class='op'>=</span> <span class='va'>pch.to.use</span>, bty <span class='op'>=</span> <span class='st'>"n"</span>,  pt.cex <span class='op'>=</span> <span class='fl'>1.5</span>, cex <span class='op'>=</span> <span class='fl'>0.8</span> ,
      text.col <span class='op'>=</span> <span class='st'>"black"</span>, horiz <span class='op'>=</span> <span class='cn'>FALSE</span>, inset <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.1</span><span class='op'>)</span>,
      title <span class='op'>=</span> <span class='st'>"Color"</span><span class='op'>)</span>
</div><div class='input'>      
<span class='co'>#Display sample assignment</span>
<span class='va'>labeled.samples</span>
</div><div class='output co'>#&gt; 1a 1b 1c 1d 1g 1e 1f 2a 2b 2c 2g 2d 2h 3g 3a 3c 3f 3d 3e 3b 3h 3i 
#&gt;  1  1  1  1  1  1  1  2  2  2  2  2  2  3  3  3  3  3  3  3  3  3 </div><div class='input'>      
<span class='co'>#Display stability of clusters</span>
<span class='fu'>gridExtra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/gridExtra/man/tableGrob.html'>grid.table</a></span><span class='op'>(</span><span class='va'>stability.table</span><span class='op'>)</span>
</div><div class='img'><img src='HierarchicalClustering-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#Display kcboot full output</span>
<span class='va'>kcboot.res</span>
</div><div class='output co'>#&gt; * Cluster stability assessment *
#&gt; Cluster method:  hclust 
#&gt; Full clustering results are given as parameter result
#&gt; of the clusterboot object, which also provides further statistics
#&gt; of the resampling results.
#&gt; Number of resampling runs:  100 
#&gt; 
#&gt; Number of clusters found in data:  3 
#&gt; 
#&gt;  Clusterwise Jaccard bootstrap (omitting multiple points) mean:
#&gt; [1] 1 1 1
#&gt; dissolved:
#&gt; [1] 0 0 0
#&gt; recovered:
#&gt; [1] 100 100 100</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Yong-Han Hank Cheng.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


